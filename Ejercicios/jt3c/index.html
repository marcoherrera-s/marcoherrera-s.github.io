<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta name=google-site-verification  content=21AT8iolyuvHcdcAj2bmdauq6mqEd4a1fF4q-bsSUQY  /> <title>6. Problema de tres cuerpos</title> <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet > <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&display=swap" rel=stylesheet > <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/latex.css"> <link rel=stylesheet  href="/css/style.css"> <link id=dark-mode-style  rel=stylesheet  href="/css/dark-mode2.css" disabled> <script src="https://kit.fontawesome.com/1966c00f87.js" crossorigin=anonymous ></script> <link id=highlight-style-light  rel=stylesheet  href="/libs/highlight/styles/github.min.css"> <link id=highlight-style-dark  rel=stylesheet  href="/libs/highlight/styles/lioshi.min.css" disabled> <script src="/dark-mode.js" defer></script> <div class=toggle-switch > <label class=switch-label > <input type=checkbox  class=checkbox  id=dark-mode-toggle > <span class=slider ></span> </label> </div> <div id=layout > <div id=menu > <ul> <li><a href="/menu1">Física </a> <li><a href="/menu2/">Miscelánea</a> <li><a href="/"><i class="fa-duotone fa-solid fa-house-chimney fa-xs"></i> <li><a href="/menu3/">Extra</a> <li><a href="/menu4/">Otro</a> </ul> </div> <div id=main > <script src="/script.js" defer></script> <script async defer src="//assets.pinterest.com/js/pinit.js"></script> <div class=franklin-content ><h1 id=jet_transport_para_el_problema_de_tres_cuerpos ><a href="#jet_transport_para_el_problema_de_tres_cuerpos" class=header-anchor >❉ Jet Transport para el Problema de Tres Cuerpos ❉</a></h1> <h2 id="qué_es_el_jet_transport"><a href="#qué_es_el_jet_transport" class=header-anchor >¿Qué es el Jet Transport?</a></h2> <p>Aunque ya se habló mas en detalle de la técnica <a href="/Dinamica/JetTransport/">aquí</a>. Rápidamente, <strong>Jet Transport</strong> es una técnica que extiende la solución de un sistema dinámico a una vecindad completa de condiciones iniciales en lugar de limitarse a una sola trayectoria. Al representar la solución como una serie de Taylor multivariable, podemos capturar cómo las trayectorias del sistema cambian en respuesta a pequeñas perturbaciones en las condiciones iniciales o parámetros, lo que permite estudiar la estabilidad y sensibilidad del sistema.</p> <h2 id="implementación_en_julia"><a href="#implementación_en_julia" class=header-anchor >Implementación en Julia</a></h2> <p>Regresamos a nuestra definición de nuestras ecuaciones en odnde ahora <code>du&#91;5&#93; &#61; zero&#40;μ&#41;</code> tiene más sentido, ya que vamos a hacer Jet Transport, pero no vamos a variar las condiciones iniciales, sino el parámetro de masa. </p> <pre><code class="julia hljs"><span class=hljs-meta >@taylorize</span> <span class=hljs-keyword >function</span> three_body_restricted_param!(du::<span class=hljs-built_in >Vector</span>{T}, u::<span class=hljs-built_in >Vector</span>{T}, p, t) <span class=hljs-keyword >where</span> T
    x, y, v_x, v_y, μ = u

    x_plus_mu = x + μ
    x_minus_one_plus_mu = x - <span class=hljs-number >1</span> + μ
    one_minus_mu = <span class=hljs-number >1</span> - μ  

    r1 = sqrt(x_plus_mu^<span class=hljs-number >2</span> + y^<span class=hljs-number >2</span>)
    r2 = sqrt(x_minus_one_plus_mu^<span class=hljs-number >2</span> + y^<span class=hljs-number >2</span>)

    r1_cubed = r1^<span class=hljs-number >3</span>
    r2_cubed = r2^<span class=hljs-number >3</span>

    du[<span class=hljs-number >1</span>] = v_x
    du[<span class=hljs-number >2</span>] = v_y
    du[<span class=hljs-number >3</span>] = (<span class=hljs-number >2</span>v_y + x) - (one_minus_mu * x_plus_mu / r1_cubed + μ * x_minus_one_plus_mu / r2_cubed)
    du[<span class=hljs-number >4</span>] = (-<span class=hljs-number >2</span>v_x + y) - (one_minus_mu * y / r1_cubed + μ * y / r2_cubed)
    du[<span class=hljs-number >5</span>] = zero(μ)
<span class=hljs-keyword >end</span></code></pre> <h3 id="explicación_de_las_ecuaciones"><a href="#explicación_de_las_ecuaciones" class=header-anchor >Explicación de las Ecuaciones</a></h3> <p>Estas ecuaciones de movimiento representan un sistema de tres cuerpos en el que una de las masas es significativamente menor que las otras dos &#40;problema de tres cuerpos restringido&#41;. La función <code>three_body_restricted_param&#33;</code> define cómo evoluciona el sistema con el tiempo, y el uso de <code>@taylorize</code> permite calcular automáticamente las derivadas necesarias para el Jet Transport.</p> <h3 id="configuración_inicial"><a href="#configuración_inicial" class=header-anchor >Configuración Inicial</a></h3> <pre><code class="julia hljs">varorder = <span class=hljs-number >6</span>
ξ = set_variables(<span class=hljs-string >&quot;ξ&quot;</span>, numvars=<span class=hljs-number >5</span>, order=varorder)
q0TN = [x0, y0, vx0, vy0, μ<span class=hljs-number >0</span>] .+ [<span class=hljs-number >0</span>*ξ[<span class=hljs-number >1</span>], <span class=hljs-number >0</span>*ξ[<span class=hljs-number >2</span>], <span class=hljs-number >0</span>*ξ[<span class=hljs-number >3</span>], <span class=hljs-number >0</span>*ξ[<span class=hljs-number >4</span>], ξ[<span class=hljs-number >5</span>]]</code></pre> <p>Aquí, como se estudió en la entrada mencionada al principio, el uso de <code>ξ</code> permite representar las desviaciones de las condiciones, esenciales para el Jet Transport. <code>q0TN</code> es el vector de condiciones iniciales con componentes polinómicas que representan la variación de <code>μ</code>.</p> <h3 id="integración_con_jet_transport"><a href="#integración_con_jet_transport" class=header-anchor >Integración con Jet Transport</a></h3> <pre><code class="julia hljs">result = taylorinteg(three_body_restricted_param!, q0TN, time_vector, order, abstol, maxsteps=<span class=hljs-number >900000</span>)
result.x</code></pre> <p>La función <code>taylorinteg</code> realiza la integración numérica del sistema, proporcionando una solución que no solo representa la evolución de las variables del sistema sino también su dependencia en relación con <code>μ</code> y otras perturbaciones iniciales.</p> <h3 id="análisis_y_visualización"><a href="#análisis_y_visualización" class=header-anchor >Análisis y Visualización</a></h3> <pre><code class="julia hljs">δμ_values = <span class=hljs-built_in >LinRange</span>(<span class=hljs-number >0</span>, <span class=hljs-number >0.0017995</span>, <span class=hljs-number >30</span>)
μ_values = μ<span class=hljs-number >0</span> .+ δμ_values
num_times = length(time_vector)
num_μ = length(μ_values)

xjet_plot2 = zeros(num_times, num_μ)
vjet_plot2 = zeros(num_times, num_μ)

<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:num_times
    <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:num_μ
        μ = μ_values[j]
        ξ_values = [<span class=hljs-number >0.0</span>, <span class=hljs-number >0.0</span>, <span class=hljs-number >0.0</span>, <span class=hljs-number >0.0</span>, μ - μ<span class=hljs-number >0</span>]  <span class=hljs-comment ># μ - μ0 porque ξ[5] representa la desviación de μ0</span>
        xjet_plot2[i, j] = result.x[i,<span class=hljs-number >1</span>](ξ_values)
        vjet_plot2[i, j] = result.x[i,<span class=hljs-number >2</span>](ξ_values)
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span></code></pre> <p>Aquí se calcula las trayectorias para diferentes valores de <code>μ</code>, basándose en la solución obtenida mediante Jet Transport. Las trayectorias se representan en matrices <code>xjet_plot2</code> y <code>vjet_plot2</code>.</p> <h3 id="visualización_de_resultados"><a href="#visualización_de_resultados" class=header-anchor >Visualización de Resultados</a></h3> <pre><code class="julia hljs">plotly()
p = plot(legend=:outertopleft, alpha=<span class=hljs-number >1.0</span>)
<span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:num_μ
    plot!(xjet_plot2[:, j], vjet_plot2[:, j], label=<span class=hljs-string >&quot;μ = <span class=hljs-subst >$(round(μ_values[j], digits=<span class=hljs-number >5</span>)</span>)&quot;</span>)
<span class=hljs-keyword >end</span>
display(p)</code></pre> <p>Como podemos ver, tenemos una serie de trayectorias que parece que de alguna forma van divergiendo. </p> <p><img src="/Ejercicios/1jet.png" alt=jet  /></p> <p>Acerquémonos un poco más a la región en donde parece que todo estaba bien.</p> <p><img src="/Ejercicios/2jet.png" alt=jet  /></p> <p>Un poco más.</p> <p><img src="/Ejercicios/jet3.png" alt=jet  /></p> <p>De esta forma no es tan práctico observar cómo es que las trayectorias van divergiendo conforme vamos cambiando el parámetro de masa, pero en la siguiente animación se ve un poco más claro de qué es lo que está pasando.</p> <pre><code class="julia hljs">anim = <span class=hljs-meta >@animate</span> <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:num_μ
    plot(legend=:outertopleft, alpha=<span class=hljs-number >1.0</span>)
    plot!(xjet_plot2[:, j], vjet_plot2[:, j], 
          label=<span class=hljs-string >&quot;μ = <span class=hljs-subst >$(round(μ_values[j], digits=<span class=hljs-number >5</span>)</span>)&quot;</span>,
          xlabel=<span class=hljs-string >&quot;x&quot;</span>, ylabel=<span class=hljs-string >&quot;v&quot;</span>)
    title!(<span class=hljs-string >&quot;μ = <span class=hljs-subst >$(round(μ_values[j], digits=<span class=hljs-number >5</span>)</span>)&quot;</span>)
<span class=hljs-keyword >end</span>

<span class=hljs-comment ># Guardar la animación como un gif</span>
gif(anim, <span class=hljs-string >&quot;trayectorias.gif&quot;</span>, fps=<span class=hljs-number >7</span>)</code></pre> <p><img src="/Ejercicios/trayectorias_mejoradas.gif" alt=gif  /></p> <p>La animación creada muestra la evolución de las trayectorias a medida que <code>μ</code> varía, el punto rojo muestra el final de la trayectoria para el tiempo especificado, esto es el comportamiento del sistema cerca de L5.</p> <p>Por lo tanto, el uso de <strong>Jet Transport</strong> en combinación con <strong>TaylorIntegration.jl</strong> permite no solo resolver las ecuaciones de movimiento de un sistema complejo como el problema de tres cuerpos, sino también explorar cómo las variaciones en las condiciones iniciales y los parámetros afectan el comportamiento del sistema. </p> <!-- <div class=page-foot  style="font-size: 8px; font-family: 'Sans-serif', Arial, sans-serif; text-align: center; color: #666;"> <span>&copy; {{ fill author }}.</span> {{isnotpage /tag/*}}<span>Última modificación: {{ fill fd_mtime }}.</span>{{end}} <br> Sitio creado con <a href="https://github.com/tlienart/Franklin.jl" target=_blank  style="color: #90be6d; text-decoration: none;">Franklin.jl</a> y <a href="https://julialang.org" target=_blank  style="color: #90be6d; text-decoration: none;">Julia programming language</a>. </div> --> </div> </div> </div> <script src="/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>