<!doctype html> <html lang=en > <div class=toggle-switch > <label class=switch-label > <input type=checkbox  class=checkbox  id=dark-mode-toggle > <span class=slider ></span> </label> </div> <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <meta name=google-site-verification  content=21AT8iolyuvHcdcAj2bmdauq6mqEd4a1fF4q-bsSUQY  /> <title>3. Problema de tres cuerpos</title> <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet > <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&display=swap" rel=stylesheet > <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/tufte.css"> <link rel=stylesheet  href="/css/latex.css"> <link rel=stylesheet  href="/css/adjust.css"> <link id=dark-mode-style  rel=stylesheet  href="/css/dark-mode.css" disabled> <script src="https://kit.fontawesome.com/1966c00f87.js" crossorigin=anonymous ></script> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/styles/monokai-sublime.min.css"> <script> document.addEventListener('DOMContentLoaded', function() { const toggleSwitch = document.querySelector('.toggle-switch .checkbox'); const darkModeStyle = document.getElementById('dark-mode-style'); const currentTheme = localStorage.getItem('theme'); if (currentTheme === 'dark') { document.body.classList.add('dark-mode'); darkModeStyle.disabled = false; if (toggleSwitch) { toggleSwitch.checked = true; } } if (toggleSwitch) { toggleSwitch.addEventListener('change', function() { if (this.checked) { document.body.classList.add('dark-mode'); darkModeStyle.disabled = false; localStorage.setItem('theme', 'dark'); } else { document.body.classList.remove('dark-mode'); darkModeStyle.disabled = true; localStorage.setItem('theme', 'light'); } }); } }); </script> <div id=layout > <div id=menu > <ul> <li><a style="font-size:larger;" href=https://github.com/marcoherrera-s><i class="fa-brands fa-github"></i></a> <li><a style="font-size:larger;" href=https://letterboxd.com/marcoherrera/><i class="fa-brands fa-letterboxd" style="color: #c01c28;"></i></a> <li><a style="font-size:larger;" href=https://www.goodreads.com/user/show/71696585-marco-herrera><i class="fa-brands fa-goodreads"></i></a> <li><a href="/"><i class="fa-duotone fa-solid fa-house-chimney fa-xs"></i> <li><a href="/menu1">Física </a> <li><a href="/menu2/">Miscelánea</a> <li><a href="/menu3/">Extra</a> <li><a href="/menu4/">Otro</a> </ul> </div> <div id=main > <script src=script.js  defer></script> <script async defer src="//assets.pinterest.com/js/pinit.js"></script> <div class=franklin-content ><h1 id=resolviendo_el_problema_de_tres_cuerpos ><a href="#resolviendo_el_problema_de_tres_cuerpos" class=header-anchor >Resolviendo el problema de tres cuerpos</a></h1> <p>Recordando las ecuaciones de movimiento que obtuvimos:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.25em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mover accent=true ><mi>x</mi><mo>˙</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mi>v</mi><mi>x</mi></msub><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mover accent=true ><mi>y</mi><mo>˙</mo></mover></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mi>v</mi><mi>y</mi></msub><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mover accent=true ><mi>v</mi><mo>˙</mo></mover><mi>x</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mn>2</mn><msub><mi>v</mi><mi>y</mi></msub><mo>−</mo><mfrac><mrow><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>μ</mi><mo stretchy=false >)</mo></mrow><msup><mrow><mo fence=true >[</mo><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>μ</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo fence=true >]</mo></mrow><mrow><mn>3</mn><mi mathvariant=normal >/</mi><mn>2</mn></mrow></msup></mfrac><mo>−</mo><mfrac><mrow><mi>μ</mi><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo>+</mo><mi>μ</mi><mo stretchy=false >)</mo></mrow><msup><mrow><mo fence=true >[</mo><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo>+</mo><mi>μ</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo fence=true >]</mo></mrow><mrow><mn>3</mn><mi mathvariant=normal >/</mi><mn>2</mn></mrow></msup></mfrac><mo>+</mo><mi>x</mi><mo separator=true >,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><msub><mover accent=true ><mi>v</mi><mo>˙</mo></mover><mi>y</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mo>−</mo><mn>2</mn><msub><mi>v</mi><mi>x</mi></msub><mo>−</mo><mfrac><mrow><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mo stretchy=false >)</mo><mi>y</mi></mrow><msup><mrow><mo fence=true >[</mo><mo stretchy=false >(</mo><mi>x</mi><mo>+</mo><mi>μ</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo fence=true >]</mo></mrow><mrow><mn>3</mn><mi mathvariant=normal >/</mi><mn>2</mn></mrow></msup></mfrac><mo>−</mo><mfrac><mrow><mi>μ</mi><mi>y</mi></mrow><msup><mrow><mo fence=true >[</mo><mo stretchy=false >(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo>+</mo><mi>μ</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo fence=true >]</mo></mrow><mrow><mn>3</mn><mi mathvariant=normal >/</mi><mn>2</mn></mrow></msup></mfrac><mo>+</mo><mi>y</mi><mo separator=true >,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex"> \begin{aligned} \dot{x} &amp;= v_x, \\ \dot{y} &amp;= v_y, \\ \dot{v}_x &amp;= 2 v_y - \frac{(1 - \mu)(x + \mu)}{\left[(x + \mu)^2 + y^2\right]^{3/2}} - \frac{\mu(x - 1 + \mu)}{\left[(x - 1 + \mu)^2 + y^2\right]^{3/2}} + x, \\ \dot{v}_y &amp;= -2 v_x - \frac{(1 - \mu)y}{\left[(x + \mu)^2 + y^2\right]^{3/2}} - \frac{\mu y}{\left[(x - 1 + \mu)^2 + y^2\right]^{3/2}} + y, \\ \end{aligned} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:8.7898em;vertical-align:-4.1449em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:4.6449em;"><span style="top:-7.2319em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6679em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.1111em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span><span style="top:-5.7319em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6679em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0833em;"><span class=mord >˙</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.1944em;"><span></span></span></span></span></span></span></span><span style="top:-3.6449em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6679em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.1111em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.75em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6679em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.1111em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.1449em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:4.6449em;"><span style="top:-7.2319em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span><span style="top:-5.7319em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mpunct >,</span></span></span><span style="top:-3.6449em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord >2</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.11em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0279em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2579em;"><span class=pstrut  style="height:3.0279em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7049em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose >)</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.1679em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.11em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0279em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2579em;"><span class=pstrut  style="height:3.0279em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7049em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class="mord mathnormal">μ</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.1679em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class=mpunct >,</span></span></span><span style="top:-0.75em;"><span class=pstrut  style="height:3.427em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mord >−</span><span class=mord >2</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.11em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0279em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2579em;"><span class=pstrut  style="height:3.0279em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7049em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.1679em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.1076em;"><span style="top:-2.11em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class=minner ><span class=minner ><span class="mopen delimcenter" style="top:0em;">[</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">μ</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:1.0279em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3/2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.2579em;"><span class=pstrut  style="height:3.0279em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7049em;"><span class=pstrut  style="height:3.0279em;"></span><span class=mord ><span class="mord mathnormal">μ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.1679em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mpunct >,</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.1449em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>Ahora, vamos a resolver numéricamente. Pero antes, hay algo divertido para comentar.</p> <h3 id=el_macro_taylorize ><a href="#el_macro_taylorize" class=header-anchor >El macro <code>@taylorize</code></a></h3> <p>El macro <code>@taylorize</code> es parte de la paquetería que vamos a usar para resolver las ecuaciones numéricamente, TaylorIntegration.jl de Julia, y está pensado para optimizar la integración de ecuaciones diferenciales usando el método de Taylor. Pero antes de entrar en detalles, vale la pena mencionar qué es un macro en Julia: los macros son elementos de <em>metaprogramación</em> que permiten generar y transformar código antes de que se ejecute. En pocas palabras, son herramientas que ayudan a escribir programas más eficientes o reducir la repetición de código.</p> <p>Volviendo a <code>@taylorize</code>, su función principal es analizar automáticamente la definición de las EDOs y generar métodos especializados que optimizan las funciones de integración. Esta optimización se logra evitando asignaciones temporales y cálculos redundantes, lo que hace que la integración sea más rápida y eficiente.</p> <p>Es importante recordar que este macro está en fase experimental, de hecho en la página hay un <em>WARNING</em> enorme, por lo que, aunque puede mejorar el rendimiento, es buena práctica revisar los resultados para garantizar que la optimización sea precisa.</p> <h3 id="estructura_de_la_función_three_body_restricted_param"><a href="#estructura_de_la_función_three_body_restricted_param" class=header-anchor >Estructura de la función <code>three_body_restricted_param&#33;</code></a></h3> <p>En Julia, las funciones que describen ODEs suelen estructurarse de forma estándar, donde <code>du</code> es el vector de derivadas a calcular, <code>u</code> contiene las variables de estado, <code>p</code> representa parámetros adicionales, y <code>t</code> es el tiempo actual. </p> <p>La estructura de la función <code>three_body_restricted_param&#33;</code> es la siguiente:</p> <pre><code class="julia hljs"><span class=hljs-meta >@taylorize</span> <span class=hljs-keyword >function</span> three_body_restricted_param!(du::<span class=hljs-built_in >Vector</span>{T}, u::<span class=hljs-built_in >Vector</span>{T}, p, t) <span class=hljs-keyword >where</span> T

x, y, v_x, v_y, μ = u
x_plus_mu = x + μ
x_minus_one_plus_mu = x - <span class=hljs-number >1</span> + μ
one_minus_mu = <span class=hljs-number >1</span> - μ

r1 = sqrt(x_plus_mu^<span class=hljs-number >2</span> + y^<span class=hljs-number >2</span>)
r2 = sqrt(x_minus_one_plus_mu^<span class=hljs-number >2</span> + y^<span class=hljs-number >2</span>)
r1_cubed = r1^<span class=hljs-number >3</span>
r2_cubed = r2^<span class=hljs-number >3</span>

du[<span class=hljs-number >1</span>] = v_x
du[<span class=hljs-number >2</span>] = v_y
du[<span class=hljs-number >3</span>] = (<span class=hljs-number >2</span>v_y + x) - (one_minus_mu * x_plus_mu / r1_cubed + μ * x_minus_one_plus_mu / r2_cubed)
du[<span class=hljs-number >4</span>] = (-<span class=hljs-number >2</span>v_x + y) - (one_minus_mu * y / r1_cubed + μ * y / r2_cubed)
du[<span class=hljs-number >5</span>] = zero(μ)

<span class=hljs-keyword >end</span></code></pre> <ol> <li><p><strong>Argumentos de entrada:</strong></p> <ul> <li><p><code>du::Vector&#123;T&#125;</code>: Vector de salida donde se almacenan las derivadas de las variables de estado &#40;las ecuaciones de movimiento&#41;.</p> <li><p><code>u::Vector&#123;T&#125;</code>: Vector de entrada que contiene las variables de estado, en este caso, la posición <code>&#40;x, y&#41;</code>, las velocidades <code>&#40;v_x, v_y&#41;</code>, y el parámetro <code>μ</code>.</p> <li><p><code>p</code> y <code>t</code>: Se incluyen para seguir la estructura estándar de las funciones ODE en Julia, aunque no se usan en este caso.</p> </ul> </ol> <h3 id="definiciones_previas_para_optimización"><a href="#definiciones_previas_para_optimización" class=header-anchor >Definiciones previas para optimización</a></h3> <p>Dentro de la función, se realizan algunas definiciones de variables adicionales antes de calcular las derivadas. Estas definiciones incluyen las siguientes:</p> <ul> <li><p><strong>Posiciones relativas y distancias</strong>: </p> </ul> <pre><code class="julia hljs">x_plus_mu = x + μ
   x_minus_one_plus_mu = x - <span class=hljs-number >1</span> + μ
   one_minus_mu = <span class=hljs-number >1</span> - μ
   r1 = sqrt(x_plus_mu^<span class=hljs-number >2</span> + y^<span class=hljs-number >2</span>)
   r2 = sqrt(x_minus_one_plus_mu^<span class=hljs-number >2</span> + y^<span class=hljs-number >2</span>)
   r1_cubed = r1^<span class=hljs-number >3</span>
   r2_cubed = r2^<span class=hljs-number >3</span></code></pre> <p>Estas expresiones calculan las posiciones relativas y distancias de los cuerpos en el sistema. En vez de calcular estas cantidades en cada derivada, las definimos una sola vez al inicio, almacenando los valores de <code>r1</code> y <code>r2</code> junto con sus potencias cúbicas &#40;<code>r1_cubed</code> y <code>r2_cubed</code>&#41;. Esto evita cálculos repetidos y reduce el uso de memoria.</p> <h3 id="cálculo_de_las_derivadas"><a href="#cálculo_de_las_derivadas" class=header-anchor >Cálculo de las derivadas</a></h3> <p>Las derivadas se asignan a los elementos del vector <code>du</code> de la siguiente manera:</p> <pre><code class="julia hljs">du[<span class=hljs-number >1</span>] = v_x
du[<span class=hljs-number >2</span>] = v_y
du[<span class=hljs-number >3</span>] = (<span class=hljs-number >2</span>v_y + x) - (one_minus_mu * x_plus_mu / r1_cubed + μ * x_minus_one_plus_mu / r2_cubed)
du[<span class=hljs-number >4</span>] = (-<span class=hljs-number >2</span>v_x + y) - (one_minus_mu * y / r1_cubed + μ * y / r2_cubed)
du[<span class=hljs-number >5</span>] = zero(μ)</code></pre> <ul> <li><p><code>du&#91;1&#93;</code> y <code>du&#91;2&#93;</code> representan las ecuaciones de velocidad para <code>x</code> y <code>y</code>.</p> <li><p><code>du&#91;3&#93;</code> y <code>du&#91;4&#93;</code> corresponden a las aceleraciones, donde se incluyen términos de fuerza gravitacional y de la velocidad perpendicular.</p> <li><p><code>du&#91;5&#93; &#61; zero&#40;μ&#41;</code> es un caso especial que se estudiará más tarde para el método de <em>Jet Trasnport</em>.</p> </ul> <p>Pero antes, debemos obtener nuestras condiciones iniciales. </p> <div class=page-foot  style="font-size: 8px; font-family: 'Sans-serif', Arial, sans-serif; text-align: center; color: #666;"> <span>&copy; Marco Herrera Solar.</span> <span>Última modificación: December 14, 2024.</span> <br> Sitio creado con <a href="https://github.com/tlienart/Franklin.jl" target=_blank  style="color: #007acc; text-decoration: none;">Franklin.jl</a> y <a href="https://julialang.org" target=_blank  style="color: #007acc; text-decoration: none;">Julia programming language</a>. </div> </div> </div> </div> <script src="/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>